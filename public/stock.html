<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Stock Status Tracker</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/css/bootstrap.min.css" rel="stylesheet">
    <style>
        body { background: #378b96; }
        .container { max-width: 600px; margin-top: 40px; background: #c6e2e9; border-radius: 16px; box-shadow: 0 2px 16px #0002; padding: 32px; }
        .d-none { display: none !important; }
    </style>
</head>
<body>
<div class="container">
    <h1 class="mb-4 text-center">Stock Status Manager</h1>
    <div class="mb-3 text-end">
        <a href="index.html" class="btn btn-outline-secondary btn-sm">‚Üê Back to Main Page</a>
    </div>
    <ul id="itemsList" class="list-group"></ul>
</div>
<script>
let token = localStorage.getItem('token') || "";
async function loadItems() {
    const res = await fetch('/items', {
        headers: { 'Authorization': 'Bearer ' + token }
    });
    const items = await res.json();
    const list = document.getElementById('itemsList');
    list.innerHTML = '';
    (items || []).forEach(item => {
        const li = document.createElement('li');
        li.className = 'list-group-item d-flex justify-content-between align-items-center';
        li.innerHTML = `
            <span>
                <strong>${item.name}</strong> (${item.category}) -
                <span class="badge ${item.status === 'Out of Stock' ? 'bg-danger' : 'bg-success'}">${item.status}</span>
                <span class="badge bg-secondary ms-2">${item.quantity}</span>
            </span>
            <span>
                <button class="btn btn-sm ${item.status === 'Out of Stock' ? 'btn-outline-success' : 'btn-outline-danger'} me-1"
                    onclick="toggleStatus('${item._id}', '${item.status}')">
                    Mark as ${item.status === 'Out of Stock' ? 'In Stock' : 'Out of Stock'}
                </button>
            </span>
        `;
        list.appendChild(li);
    });
}
window.toggleStatus = async function(id, currentStatus) {
    const newStatus = currentStatus === 'In Stock' ? 'Out of Stock' : 'In Stock';
    await fetch(`/items/${id}/status`, {
        method: 'PUT',
        headers: { 'Content-Type': 'application/json', 'Authorization': 'Bearer ' + token },
        body: JSON.stringify({ status: newStatus })
    });
    loadItems();
};
// Initial load
loadItems();
</script>
</body>
</html>
